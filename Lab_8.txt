#Zadanie 1
select * from CLIENT;
create table CLIENT_ADDRESS LIKE company_2025.CLIENT_ADDRESS;
INSERT into CLIENT_ADDRESS SELECT * from company_2025.CLIENT_ADDRESS;
select * from CLIENT_ADDRESS;
select * from company_2025.ADDRESS_TYPE;
create table ADDRESS_TYPE LIKE company_2025.ADDRESS_TYPE;
INSERT into ADDRESS_TYPE SELECT * from company_2025.ADDRESS_TYPE;
select * from ADDRESS_TYPE;

select concat(c.FULL_NAME, ' ', cl.STREET, '' , LENGTH(cl.STREET), ' ', SUBSTRING(cl.STREET, 3, 8) ) AS INFO from CLIENT c join CLIENT_ADDRESS cl on c.CLIENT_ID=cl.CLIENT_ID  ;
SELECT c.SHORT_NAME, a.ADDRESS_TYPE_NAME  FROM CLIENT c LEFT join CLIENT_ADDRESS cl on c.CLIENT_ID=cl.CLIENT_ID LEFT join ADDRESS_TYPE a on cl.ADDRESS_TYPE=a.ADDRESS_TYPE_ID ;

create table CATEGORY LIKE company_2025.CATEGORY;
INSERT into CATEGORY SELECT * from company_2025.CATEGORY;
SELECT * FROM CATEGORY;
select p.PRODUCT_NAME, c.CATEGORY_NAME, left(p.PRODUCT_NAME, 3) FROM PRODUCT p JOIN CATEGORY c on p.CATEGORY_ID = c.CATEGORY_ID;

SELECT * from PRODUCT;
SELECT * from `ORDER_POSITION`;
SELECT distinct p.PRODUCT_NAME, p.DESCRIPTION  FRom PRODUCT p JOIN ORDER_POSITION o on p.PRODUCT_ID=o.PRODUCT_ID;


#ZADANIE 2
SELECT c.FULL_NAME, o.ORDER_NUMBER, o.ORDER_DATE, DATEDIFF(NOW(), o.ORDER_DATE)  FROM CLIENT c JOIN `ORDER` o on c.CLIENT_ID=o.CLIENT_ID;
create table ORDER_STATUS LIKE company_2025.ORDER_STATUS;
INSERT into ORDER_STATUS SELECT * from company_2025.ORDER_STATUS;
select date_add( o.ORDER_DATE, INTERVAL 14 DAY) FROM `ORDER` o join ORDER_STATUS s on o.ORDER_STATUS=s.STATUS_ID WHERE s.STATUS_NAME NOT in ('Zwrocone', 'Zamkniete');
SELECT e.FIRST_NAME, e.LAST_NAME, dayname(e.DATE_OF_EMPLOYMENT)  , now() , d.DEPARTMENT_NAME  from EMPLOYEE e
 LEFT join DEPARTMENT d on e.DEPARTMENT_ID =d.DEPARTMENT_ID ORDER by d.DEPARTMENT_NAME;
 
select * FROM EMPLOYEE;
SElect * FROM DEPARTMENT;
SELECT * FROm `ORDER`;
select * FROM CLIENT;

SELECT c.SHORT_NAME, datediff(MAX(o.ORDER_DATE) , min(o.ORDER_DATE)) FROM CLIENT c LEFT join `ORDER` o on c.CLIENT_ID= o.CLIENT_ID GROUP BY c.CLIENT_ID, c.SHORT_NAME;

#ZADANIE 3
SELECT c.CLIENT_ID, GROUP_CONCAT(a.STREET separator ', ') FROM CLIENT c LEFT JOIN CLIENT_ADDRESS a on c.CLIENT_ID=a.CLIENT_ID group by c.CLIENT_ID;
SELECT CITY , GROUP_CONCAT(DISTINCT left(POSTAL_CODE , 2) separator ', ') as PC FROM CLIENT_ADDRESS group by CITY;

SELECT concat(FIRST_NAME , ' ' ,LAST_NAME), d.DEPARTMENT_NAME, datediff(now(), e.DATE_OF_EMPLOYMENT)  FROM EMPLOYEE e join DEPARTMENT d on e.DEPARTMENT_ID = d.DEPARTMENT_ID;

SELECT CONCAT(FULL_NAME, ' - ', SHORT_NAME), group_concat(RIGHT(o.ORDER_NUMBER, 3) separator ', ') FROM CLIENT c JOIN `ORDER` o on c.CLIENT_ID=o.CLIENT_ID GROUP BY c.CLIENT_ID, c.FULL_NAME, c.SHORT_NAME;

SELECT FIRST_NAME ,concat(LEFT(FIRST_NAME, 3) , UPPER(RIGHT(LAST_NAME, 4)) , (LENGTH(FIRST_NAME) + YEAR(BIRTH_DATE) + MONTH(BIRTH_DATE) + DAY(BIRTH_DATE)) ) FROM EMPLOYEE

#ZADANIE 4
SELECT DATE_FORMAT(ORDER_DATE, '%d-%m-%Y') FROM `ORDER`;
SELECT DATE_FORMAT(ORDER_DATE, '%Y - %u') FROM `ORDER`;
SELECT DATE_FORMAT(ORDER_DATE, '%Y - %j') FROM `ORDER`;
SELECT DATE_FORMAT(ORDER_DATE, '%M/%d/%Y') FROM `ORDER`;

