#zadanie 1
SELECT avg(pensja) FROM EMPLOYEE;
SELECT avg(pensja), count(JOB_POSITION_ID) FROM EMPLOYEE group by JOB_POSITION_ID;
select avg(year(curdate()) - year(BIRTH_DATE)) AS WIEK from EMPLOYEE group by DEPARTMENT_ID;
desc EMPLOYEE;

#zadanie 2
SELECT DEPARTMENT_ID, sum(pensja)  as laczna_pensja FROM EMPLOYEE group by DEPARTMENT_ID order by laczna_pensja;
select JOB_POSITION_ID, AVG(pensja) FROM EMPLOYEE GROUP BY JOB_POSITION_ID HAVING count(*)>= 3 and AVG(PENSJA) > 3000;
SELECT department_id , COUNT(distinct pensja) FROM EMPLOYEE group by DEPARTMENT_ID HAVING count(*) > 5 order by COUNT(DISTINCT pensja )ASC;

#zadanie 3
CREATE TABLE DEPARTMENT LIKE company_2025.DEPARTMENT;
CREATE TABLE JOB_POSITION LIKE company_2025.JOB_POSITION;
INSERT INTO DEPARTMENT select * FROm company_2025.DEPARTMENT;
INSERT INTO JOB_POSITION select * FROM company_2025.JOB_POSITION;
desc DEPARTMENT;
desc EMPLOYEE;
SELECT * FROM EMPLOYEE;
select D.DEPARTMENT_NAME , count(E.EMPLOYEE_NAME) FROM EMPLOYEE E, DEPARTMENT D WHERE E.DEPARTMENT_ID=D.DEPARTMENT_ID GROUP BY D.DEPARTMENT_NAME;
select group_concat(E.FIRST_NAME , ' ', E.LAST_NAME)  FROM EMPLOYEE E, DEPARTMENT D WHERE E.DEPARTMENT_ID=D.DEPARTMENT_ID GROUP BY D.DEPARTMENT_NAME;

#zadanie 4
SELECT LAST_NAME, POSITION_NAME FROM EMPLOYEE natural join JOB_POSITION WHERE year(BIRTH_DATE) between 1990 AND 1999;
SELECT E.LAST_NAME, E.FIRST_NAME FROM EMPLOYEE E join JOB_POSITION J on E.JOB_POSITION_ID = J.JOB_POSITION_ID WHERE J.POSITION_NAME = 'Magazynier' ORDER BY E.BIRTH_Date DESC LIMIT 5;
SELECT concat(C1.SHORT_NAME, ' - ', C2.SHORT_NAME) FROM CLIENT C1 JOIN CLIENT C2 on C1.CLIENT_ID = C2.CLIENT_ID +5 ;

#zadanie 5
SELECT avg(pensja) FROM EMPLOYEE E JOIN DEPARTMENT D on E.DEPARTMENT_ID = D.DEPARTMENT_ID
WHERE  D.DEPARTMENT_NAME NOT IN ('IT' , 'HR') group by D.DEPARTMENT_ID having count(E.DEPARTMENT_ID) > 3;
