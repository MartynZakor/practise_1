#zadanie 1

SELECT * from CLIENT c left join `ORDER` o on c.CLIENT_ID=o.CLIENT_ID WHERE o.CLIENT_ID is NULL;
SELECT CLIENT_ID FROM CLIENT WHERE CLIENT_ID not in (SELECT CLIENT_ID from `ORDER`);

CREATE table INVENTORY LIKE company_2025.INVENTORY;
INSERT INTO INVENTORY SELECT * from company_2025.INVENTORY;
select * from company_2025.UNIT_OF_MEASUREMENT;
CREATE table UNIT_OF_MEASUREMENT LIKE company_2025.UNIT_OF_MEASUREMENT;
INSERT INTO UNIT_OF_MEASUREMENT SELECT * from company_2025.UNIT_OF_MEASUREMENT;

SELECT * FROM INVENTORY;
SELECT * FROm UNIT_OF_MEASUREMENT;
SELECT u.UNIT_NAME FROM INVENTORY i RIGHT JOIN UNIT_OF_MEASUREMENT u on i.UNIT_ID = u.UNIT_ID WHERE i.UNIT_ID IS NULL;

CREATE table PRODUCT LIKE company_2025.PRODUCT;
INSERT INTO PRODUCT SELECT * from company_2025.PRODUCT;
CREATE table ORDER_POSITION LIKE company_2025.ORDER_POSITION;
INSERT INTO ORDER_POSITION SELECT * from company_2025.ORDER_POSITION;
SELECT * from  ORDER_POSITION;
select * from PRODUCT;

SELECT p.PRODUCT_NAME, AVG(o.SELL_PRICE - p.PURCHASE_PRICE) as roznica from ORDER_POSITION o JOIN PRODUCT p on o.PRODUCT_ID=p.PRODUCT_ID group by p.PRODUCT_NAME order by roznica DESC;


#Zadanie 2
SELECT * FROM DEPARTMENT;
SELECT * FROM EMPLOYEE;
SELECT * FROM `ORDER`;
select * FROM PRODUCT;
SELECT * FROM ORDER_POSITION;
select * FROM company_2025.ORDER_STATUS;
SELECT distinct d.DEPARTMENT_NAME FROM `ORDER` o join EMPLOYEE e on o.EMPLOYEE_ID=e.EMPLOYEE_NAME JOIN DEPARTMENT d on e.DEPARTMENT_ID=d.DEPARTMENT_ID  ;


SELECT d.DEPARTMENT_NAME, os.STATUS_NAME ,SUM(op.AMOUNT * op.SELL_PRICE) FROM DEPARTMENT d  JOIN EMPLOYEE e ON d.DEPARTMENT_ID = e.DEPARTMENT_ID
JOIN `ORDER` o ON e.EMPLOYEE_NAME = o.EMPLOYEE_ID
JOIN ORDER_POSITION op ON o.ORDER_ID = op.ORDER_ID
JOIN company_2025.ORDER_STATUS os ON o.ORDER_STATUS = os.STATUS_ID  
GROUP BY d.DEPARTMENT_NAME, os.STATUS_NAME;

